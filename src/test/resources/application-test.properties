spring.application.name=rewardSystem-test
server.port=8080

# ===============================
# H2 Database Configuration for Testing
# ===============================
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true

# H2 Console Configuration
spring.h2.console.enabled=true
package com.rewardSystem.entity;

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import java.util.HashMap;
import java.util.Map;

import static org.junit.jupiter.api.Assertions.*;

@DisplayName("RewardResponse Entity Test Suite")
class RewardResponseTest {

    private RewardResponse rewardResponse;

    @BeforeEach
    void setUp() {
        rewardResponse = new RewardResponse();
    }

    @Test
    @DisplayName("Should create RewardResponse with no-arg constructor")
    void testNoArgConstructor() {
        assertNotNull(rewardResponse);
    }

    @Test
    @DisplayName("Should create RewardResponse with all-arg constructor")
    void testAllArgConstructor() {
        Map<String, Integer> monthlyRewards = new HashMap<>();
        monthlyRewards.put("JANUARY", 100);
        RewardResponse response = new RewardResponse(1, monthlyRewards, 100);

        assertEquals(1, response.getCustomerId());
        assertEquals(monthlyRewards, response.getMonthlyRewards());
        assertEquals(100, response.getTotalRewardPoints());
    }

    @Test
    @DisplayName("Should set and get customerId correctly")
    void testSetAndGetCustomerId() {
        rewardResponse.setCustomerId(5);
        assertEquals(5, rewardResponse.getCustomerId());
    }

    @Test
    @DisplayName("Should set and get monthlyRewards correctly")
    void testSetAndGetMonthlyRewards() {
        Map<String, Integer> monthlyRewards = new HashMap<>();
        monthlyRewards.put("JANUARY", 100);
        monthlyRewards.put("FEBRUARY", 50);

        rewardResponse.setMonthlyRewards(monthlyRewards);
        assertEquals(monthlyRewards, rewardResponse.getMonthlyRewards());
        assertEquals(2, rewardResponse.getMonthlyRewards().size());
    }

    @Test
    @DisplayName("Should set and get totalRewardPoints correctly")
    void testSetAndGetTotalRewardPoints() {
        rewardResponse.setTotalRewardPoints(250);
        assertEquals(250, rewardResponse.getTotalRewardPoints());
    }

    @Test
    @DisplayName("Should handle zero reward points")
    void testZeroRewardPoints() {
        rewardResponse.setTotalRewardPoints(0);
        assertEquals(0, rewardResponse.getTotalRewardPoints());
    }

    @Test
    @DisplayName("Should handle large reward points")
    void testLargeRewardPoints() {
        rewardResponse.setTotalRewardPoints(999999);
        assertEquals(999999, rewardResponse.getTotalRewardPoints());
    }

    @Test
    @DisplayName("Should handle empty monthly rewards map")
    void testEmptyMonthlyRewards() {
        Map<String, Integer> monthlyRewards = new HashMap<>();
        rewardResponse.setMonthlyRewards(monthlyRewards);

        assertNotNull(rewardResponse.getMonthlyRewards());
        assertEquals(0, rewardResponse.getMonthlyRewards().size());
    }

    @Test
    @DisplayName("Should handle multiple months in monthly rewards")
    void testMultipleMonthsInRewards() {
        Map<String, Integer> monthlyRewards = new HashMap<>();
        monthlyRewards.put("JANUARY", 100);
        monthlyRewards.put("FEBRUARY", 75);
        monthlyRewards.put("MARCH", 50);
        monthlyRewards.put("APRIL", 25);

        rewardResponse.setMonthlyRewards(monthlyRewards);
        assertEquals(4, rewardResponse.getMonthlyRewards().size());
        assertEquals(100, rewardResponse.getMonthlyRewards().get("JANUARY"));
    }

    @Test
    @DisplayName("Should convert to string correctly")
    void testToString() {
        rewardResponse.setCustomerId(1);
        Map<String, Integer> monthlyRewards = new HashMap<>();
        monthlyRewards.put("JANUARY", 100);
        rewardResponse.setMonthlyRewards(monthlyRewards);
        rewardResponse.setTotalRewardPoints(100);

        String toString = rewardResponse.toString();
        assertNotNull(toString);
        assertTrue(toString.contains("RewardResponse"));
        assertTrue(toString.contains("customerId=1"));
        assertTrue(toString.contains("totalRewardPoints=100"));
    }

    @Test
    @DisplayName("Should handle null monthly rewards gracefully")
    void testNullMonthlyRewards() {
        rewardResponse.setMonthlyRewards(null);
        assertNull(rewardResponse.getMonthlyRewards());
    }

    @Test
    @DisplayName("Should set all fields independently")
    void testSetAllFieldsIndependently() {
        rewardResponse.setCustomerId(1);
        rewardResponse.setTotalRewardPoints(100);
        Map<String, Integer> monthlyRewards = new HashMap<>();
        rewardResponse.setMonthlyRewards(monthlyRewards);

        assertEquals(1, rewardResponse.getCustomerId());
        assertEquals(100, rewardResponse.getTotalRewardPoints());
        assertNotNull(rewardResponse.getMonthlyRewards());
    }

    @Test
    @DisplayName("Should handle multiple RewardResponse objects independently")
    void testMultipleRewardResponsesIndependence() {
        RewardResponse response1 = new RewardResponse(1, new HashMap<>(), 100);
        RewardResponse response2 = new RewardResponse(2, new HashMap<>(), 200);

        assertNotEquals(response1.getCustomerId(), response2.getCustomerId());
        assertNotEquals(response1.getTotalRewardPoints(), response2.getTotalRewardPoints());
    }

    @Test
    @DisplayName("Should correctly aggregate monthly points")
    void testCorrectAggregateMonthlyPoints() {
        Map<String, Integer> monthlyRewards = new HashMap<>();
        monthlyRewards.put("JANUARY", 100);
        monthlyRewards.put("FEBRUARY", 75);
        monthlyRewards.put("MARCH", 50);

        rewardResponse.setMonthlyRewards(monthlyRewards);
        rewardResponse.setTotalRewardPoints(225); // Sum of monthly points

        assertEquals(225, rewardResponse.getTotalRewardPoints());
    }

    @Test
    @DisplayName("Should handle all month values")
    void testAllMonthValues() {
        Map<String, Integer> monthlyRewards = new HashMap<>();
        String[] months = {"JANUARY", "FEBRUARY", "MARCH", "APRIL", "MAY", "JUNE", 
                          "JULY", "AUGUST", "SEPTEMBER", "OCTOBER", "NOVEMBER", "DECEMBER"};

        for (int i = 0; i < months.length; i++) {
            monthlyRewards.put(months[i], (i + 1) * 10);
        }

        rewardResponse.setMonthlyRewards(monthlyRewards);
        assertEquals(12, rewardResponse.getMonthlyRewards().size());
    }

    @Test
    @DisplayName("Should have valid constructor with monthly rewards")
    void testConstructorWithMonthlyRewards() {
        Map<String, Integer> monthlyRewards = new HashMap<>();
        monthlyRewards.put("JANUARY", 150);

        RewardResponse response = new RewardResponse(5, monthlyRewards, 150);

        assertEquals(5, response.getCustomerId());
        assertEquals(150, response.getTotalRewardPoints());
        assertEquals(1, response.getMonthlyRewards().size());
        assertEquals(150, response.getMonthlyRewards().get("JANUARY"));
    }
}

